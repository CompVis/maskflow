<!DOCTYPE html>
<html>
<head>
  <!-- Libraries & meta setup -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://kit.fontawesome.com/f8ddf9854a.js" crossorigin="anonymous"></script>
  <meta charset="utf-8">
  <meta name="description" content="MaskFlow: A discrete chunkwise autoregressive approach for long video generation.">
  <meta property="og:title" content="MaskFlow: Discrete Flows for Flexible and Efficient Long Video Generation"/>
  <meta property="og:description" content="Coming soon, check https://github.com/CompVis/maskflow for updates."/>
  <meta property="og:url" content="https://compvis.github.io/maskflow/"/>
  <meta property="og:image" content="static/images/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>
  <meta name="twitter:title" content="MaskFlow: Discrete Flows for Flexible and Efficient Long Video Generation">
  <meta name="twitter:description" content="Coming soon, check https://github.com/CompVis/maskflow for updates.">
  <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="keywords" content="MaskFlow, discrete flows, video generation, deep learning, generative models, AI research">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>MaskFlow: Discrete Flows for Flexible and Efficient Long Video Generation</title>

  <link rel="icon" type="image/png" href="/maskflow/static/images/maskicon.png">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <!-- Bulma & Custom CSS -->
  <link rel="stylesheet" href="/maskflow/static/css/bulma.min.css">
  <link rel="stylesheet" href="/maskflow/static/css/index.css">

  <!-- jQuery (CDN) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  <style>
    /* Fallback background color if image doesn't load */
    .hero {
      background-color: #f4f4f4;
    }
    /* Styling for the mask icon inside the title */
    .title-icon {
      vertical-align: middle;
      height: 1.2em;
      margin-right: 10px;
    }
    /* Style for figure images: no borders, white background */
    .figure-img {
      width: 100%;
      height: auto;
      background: white;
      border: none;
    }
    /* Rounded link boxes styling */
    .button.is-black {
      background-color: #000;
      border-color: transparent;
      color: #fff;
    }
    /* Style for icons inside buttons; nudged slightly left */
    .button.is-black img {
      vertical-align: middle;
      height: 1em;
      margin-right: 5px;
      margin-left: -5px;
    }
    /* BibTex box styling with reduced padding */
    .bibtex-box {
      background: #f8f8f8;
      padding: 0.5rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-family: monospace;
      white-space: pre;
    }
  </style>
</head>
<body>
  <!-- Hero Section with background image -->
  <section class="hero" style="background-image: url('/maskflow/static/images/background.avif'); background-size: cover; background-position: center;">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <!-- Page Title with Icon -->
            <h1 class="title is-1 publication-title">
              <img src="/maskflow/static/images/maskicon.png" alt="Mask Icon" class="title-icon">
              MaskFlow: Discrete Flows for Flexible and Efficient Long Video Generation
            </h1>
            <!-- Authors -->
            <div class="is-size-5 publication-authors">
              <span class="author-block">Michael Fuest,</span>
              <span class="author-block"><a href="https://taohu.me" target="_blank">Vincent Tao Hu</a>,</span>
              <span class="author-block"><a href="https://ommer-lab.com/people/ommer/" target="_blank">Bj√∂rn Ommer</a></span>
            </div>
            <!-- Institution -->
            <div class="is-size-5 publication-authors">
              <span class="author-block" style="font-weight: bold;">CompVis @ LMU Munich, MCML<br><br></span>
            </div>
            <!-- Link Boxes for ArXiv and GitHub -->
            <div class="buttons is-centered">
              <a href="https://arxiv.org/abs/2502.11234" target="_blank" class="button is-black is-rounded">
                <img src="/maskflow/static/images/pdficon.png" alt="PDF Icon">
                ArXiv
              </a>
              <a href="https://github.com/CompVis/maskflow" target="_blank" class="button is-black is-rounded">
                <img src="/maskflow/static/images/githubicon.png" alt="GitHub Icon">
                Code
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- TLDR Section with Two Columns -->
  <section class="section">
    <div class="container is-max-desktop content">
      <div class="columns is-vcentered">
        <!-- Left Column: Training Figure -->
        <div class="column is-5">
          <img src="static/images/training.png" alt="MaskFlow Training" class="figure-img">
          <p>
            <strong>MaskFlow Training:</strong> Our baseline models apply the same masking ratio to all frames during training, whereas MaskFlow applies independent frame-level masking ratios for each frame.
          </p>
        </div>
        <!-- Right Column: TLDR Text -->
        <div class="column is-7">
          <h2 class="title is-4 has-text-centered">TLDR;</h2>
          <p>
            MaskFlow is a chunkwise autoregressive approach to long video generation that uses frame-level masking and confidence-based heuristic sampling to produce seamless, high-quality video sequences efficiently. Instead of generating entire videos at once, MaskFlow generates overlapping chunks of frames, where each new chunk is conditioned on previously generated frames to ensure temporal consistency. During training, the model learns to reconstruct partially masked frames, making it naturally suited for extending video sequences while maintaining coherence. The frame-level masking strategy aligns perfectly with chunkwise generation, enabling the model to handle different levels of corruption while ensuring smooth transitions. To further speed up inference, we incorporate confidence-based heuristic sampling, selectively unmasking only the most confidently predicted tokens at each step. This approach allows MaskFlow to generate long videos with greater flexibility and efficiency than traditional methods.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Method Section with Sampling Figure -->
  <section class="section">
    <div class="container is-fullhd content">
      <h2 class="title is-4 has-text-centered">Method</h2>
      <div class="columns is-centered">
        <div class="column is-12">
          <figure style="text-align: center; width: 100%;">
            <img src="static/images/sampling.png" alt="MaskFlow Sampling" class="figure-img" style="width: 100%; max-width: none;">
            <figcaption>
              <strong>MaskFlow Sampling:</strong> Given <em>m=2</em> <span style="color: red;">context frames</span> used to initialize generation, we unmask the current window and use <span style="color: green;">newly generated frames</span> as new context frames in the next chunk of size <em>k=5</em>, using stride <em>s=3</em>. (<em>Tokenization is omitted here to simplify understanding</em>)
            </figcaption>
          </figure>
        </div>
      </div>
  </section>

  

  <!-- Qualitative Results Section -->
  <section class="section">
    <div class="container is-max-desktop content">
      <h2 class="title is-4 has-text-centered">Qualitative Results</h2>
      <div class="columns">
        <div class="column is-half">
          <figure class="image">
            <img src="static/gifs/sampling_chain_maskflow.gif" alt="MaskFlow Sampling">
          </figure>
          <p class="has-text-centered"><strong>MaskFlow (MGM-Style) Sampling</strong></p>
        </div>
        <div class="column is-half">
          <figure class="image">
            <img src="static/gifs/sampling_chain_fm.gif" alt="FM-Style Sampling">
          </figure>
          <p class="has-text-centered"><strong>FM-Style Sampling</strong></p>
        </div>
      </div>
      <p class="has-text-centered">
        Tokenization enables the use of confidence-based heuristic sampling, which is why MaskFlow can generate video chunks much faster compared to flow matching style sampling. MaskFlow is able to generate high quality videos in as little as 20 function evaluations, which makes it much more efficient compared to flow matching sampling that requires up to 250 function evaluations for high-quality results.
      </p>
      <hr>

      <!-- New Full Sequence Generation Section -->
      <div>
        <h3 class="title is-5 has-text-centered">Full Sequence Generation</h3>
        <div class="columns">
          <div class="column is-one-third">
            <video controls width="100%">
              <source src="static/videos/ffs_160f_1.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
          <div class="column is-one-third">
            <video controls width="100%">
              <source src="static/videos/ffs_160f_2.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
          <div class="column is-one-third">
            <video controls width="100%">
              <source src="static/videos/ffs_160f_3.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
        </div>
        <div class="columns">
          <div class="column is-one-third">
            <video controls width="100%">
              <source src="static/videos/ffs_160f_2_1.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
          <div class="column is-one-third">
            <video controls width="100%">
              <source src="static/videos/ffs_160f_2_2.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
          <div class="column is-one-third">
            <video controls width="100%">
              <source src="static/videos/ffs_160f_2_3.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
        </div>
        <p class="has-text-centered">
          MaskFlow is able to maintain quality at up to 160 frames on FaceForensics by conditioning on previously generated chunks.
          All models used to generate these videos were trained on 16 frame chunks only, and require only 20 function evaluations
          for each generated chunk.
        </p>
      </div>

      <hr>

      <!-- Autoregressive Generation Section for DMLab videos -->
      <h3 class="title is-5 has-text-centered">Autoregressive Generation</h3>
      <div class="columns">
        <div class="column is-one-third">
          <video controls width="100%">
            <source src="static/videos/dmlab1.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="column is-one-third">
          <video controls width="100%">
            <source src="static/videos/dmlab2.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="column is-one-third">
          <video controls width="100%">
            <source src="static/videos/dmlab3.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
      <p class="has-text-centered">
        MaskFlow can be rolled out autoregressively frame-by-frame to generate long high-quality videos beyond an
        extrapolation length of 10√ó. The videos above show a rollout of DMLab across 360 frames and still use only
        20 function evaluations per frame. The models used to generate these videos were trained on chunks of 36
        frames only.
      </p>
    </div>
  </section>

  <!-- BibTex Citation Section -->
  <section class="section">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTex</h2>
      <div class="bibtex-box" id="bibtex-code">
@article{fuest2025maskflow,
  author    = {Michael Fuest and Vincent Tao Hu and Bj√∂rn Ommer},
  title     = {MaskFlow: Discrete Flows for Flexible and Efficient Long Video Generation},
  journal   = {arXiv},
  year      = {2025},
}
      </div>
    </div>
  </section>

  <!-- Footer with Coming Soon Notice -->
  <footer class="footer">
    <div class="container has-text-centered">
      <p>
        Code coming soon! Check <a href="https://github.com/CompVis/maskflow" target="_blank">https://github.com/CompVis/maskflow</a> for updates.
      </p>
      <p>
        This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a>.
      </p>
      <p>
        Licensed under the <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
      </p>
    </div>
  </footer>
</body>
</html>
